
# HG changeset patch
# User Todd C. Miller <Todd.Miller@courtesan.com>
# Date 1476110037 21600
# Node ID 7b8357b0a3583f7d99cdb22a209cdf2f1ee8d775
# Parent  f560e06ad58431b568ce28d1c3a191e23e66dc99
add missing guard around wordexp()

diff -r f560e06ad584 -r 7b8357b0a358 src/sudo_noexec.c
--- a/src/sudo_noexec.c	Mon Oct 10 08:24:47 2016 -0600
+++ b/src/sudo_noexec.c	Mon Oct 10 08:33:57 2016 -0600
@@ -164,6 +164,7 @@
 }
 INTERPOSE(popen)
 
+#ifdef HAVE_WORDEXP
 /*
  * We can't use a wrapper for wordexp(3) since we still want to call
  * the real wordexp(3) but with WRDE_NOCMD added to the flags argument.
@@ -211,6 +212,7 @@
 #endif /* HAVE___INTERPOSE */
 }
 INTERPOSE(wordexp)
+#endif /* HAVE_WORDEXP */
 
 /*
  * On Linux we can use a seccomp() filter to disable exec.

